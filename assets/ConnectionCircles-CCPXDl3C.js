import{d as $,b as w,p as I,c as l,h as q,g as e,S as y,J as v,K as k,F as m,l as b,o as n,L as _,t as g,s as z}from"./index-Bs-3ga46.js";const F={class:"flex flex-col gap-6 p-4 max-w-7xl mx-auto"},J={class:"card bg-base-100 shadow-xl"},A={class:"card-body"},K={class:"card bg-base-100 shadow-xl"},T={class:"card-body"},G={class:"space-y-2"},H=["onUpdate:modelValue"],P=["onClick"],Q={key:0,class:"card bg-base-100 shadow-xl"},W={class:"card-body"},X={class:"space-y-2"},Y={class:"card-body p-4"},Z={class:"flex items-center gap-2 flex-wrap"},ee=["onUpdate:modelValue"],te=["value"],se=["onUpdate:modelValue"],oe=["value"],le=["onUpdate:modelValue"],ne=["onUpdate:modelValue"],ae=["onClick"],ie={key:1,class:"card bg-base-100 shadow-xl"},de={class:"card-body"},re={class:"space-y-2"},ce={class:"font-bold"},ue={class:"text-sm"},pe={key:0,class:"text-center text-base-content/50 py-4"},fe=$({name:"ConnectionCircles",__name:"ConnectionCircles",setup(ve){const f=w(""),a=w([]),r=w([]);let C=1;function j(){a.value.push({id:C++,name:""})}function L(i){a.value=a.value.filter(t=>t.id!==i),r.value=r.value.filter(t=>t.from!==i&&t.to!==i)}function M(){r.value.push({from:0,to:0,label:"",type:"positive"})}function S(i){r.value.splice(i,1)}const x=I(()=>{const i=[],t=new Map;a.value.forEach(s=>{t.set(s.id,[])}),r.value.forEach(s=>{if(s.from&&s.to){const c=t.get(s.from)||[];c.push({to:s.to,type:s.type}),t.set(s.from,c)}});function o(s,c,p,h){if(h>4)return;const N=t.get(s)||[];for(const u of N)if(c.includes(u.to)){const D=c.indexOf(u.to),U=c.slice(D).concat(u.to);if(U.length>=3){const O=U.map(V=>a.value.find(R=>R.id===V)?.name||`元素${V}`);i.push({type:"reinforcing",path:O})}}else p.has(u.to)||(p.add(u.to),o(u.to,[...c,u.to],p,h+1),p.delete(u.to))}return a.value.forEach(s=>{o(s.id,[s.id],new Set([s.id]),0)}),i.filter((s,c,p)=>c===p.findIndex(h=>h.path.join("")===s.path.join("")))});function B(){f.value="",a.value=[],r.value=[],C=1}function E(){const i={systemName:f.value,elements:a.value,connections:r.value,feedbackLoops:x.value,timestamp:new Date().toISOString()},t=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),o=URL.createObjectURL(t),d=document.createElement("a");d.href=o,d.download=`connection-circles-${Date.now()}.json`,d.click(),URL.revokeObjectURL(o)}return(i,t)=>(n(),l("div",F,[t[12]||(t[12]=q('<div class="flex items-center gap-2"><h1 class="font-title text-2xl md:text-3xl lg:text-4xl font-bold">连接圈</h1><span class="badge badge-secondary">系统思维</span></div><div class="alert alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>理解系统内的关系并识别反馈循环。通过绘制元素之间的连接，发现系统中的因果关系和反馈循环。</span></div>',2)),e("div",J,[e("div",A,[t[1]||(t[1]=e("h2",{class:"card-title"},"系统或问题",-1)),v(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=o=>f.value=o),class:"textarea textarea-bordered w-full min-h-20",placeholder:"输入你要分析的系统或问题..."},null,512),[[k,f.value]])])]),e("div",K,[e("div",T,[e("div",{class:"flex items-center justify-between mb-2"},[t[2]||(t[2]=e("h2",{class:"card-title"},"系统元素",-1)),e("button",{class:"btn btn-primary btn-sm",onClick:j},"+ 添加元素")]),e("div",G,[(n(!0),l(m,null,b(a.value,(o,d)=>(n(),l("div",{key:o.id,class:"flex items-center gap-2"},[v(e("input",{"onUpdate:modelValue":s=>o.name=s,class:"input input-bordered input-sm flex-1",placeholder:"元素名称..."},null,8,H),[[k,o.name]]),e("button",{class:"btn btn-sm btn-circle btn-ghost",onClick:s=>L(o.id)},[...t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,P)]))),128))])])]),a.value.length>1?(n(),l("div",Q,[e("div",W,[e("div",{class:"flex items-center justify-between mb-4"},[t[4]||(t[4]=e("h2",{class:"card-title"},"连接关系",-1)),e("button",{class:"btn btn-primary btn-sm",onClick:M},"+ 添加连接")]),e("div",X,[(n(!0),l(m,null,b(r.value,(o,d)=>(n(),l("div",{key:d,class:"card bg-base-200 shadow-sm"},[e("div",Y,[e("div",Z,[v(e("select",{"onUpdate:modelValue":s=>o.from=s,class:"select select-bordered select-sm"},[t[5]||(t[5]=e("option",{value:""},"选择元素",-1)),(n(!0),l(m,null,b(a.value,s=>(n(),l("option",{key:s.id,value:s.id},g(s.name),9,te))),128))],8,ee),[[_,o.from]]),t[9]||(t[9]=e("span",{class:"text-lg"},"→",-1)),v(e("select",{"onUpdate:modelValue":s=>o.to=s,class:"select select-bordered select-sm"},[t[6]||(t[6]=e("option",{value:""},"选择元素",-1)),(n(!0),l(m,null,b(a.value,s=>(n(),l("option",{key:s.id,value:s.id},g(s.name),9,oe))),128))],8,se),[[_,o.to]]),v(e("input",{"onUpdate:modelValue":s=>o.label=s,class:"input input-bordered input-sm flex-1 min-w-32",placeholder:"连接标签..."},null,8,le),[[k,o.label]]),v(e("select",{"onUpdate:modelValue":s=>o.type=s,class:"select select-bordered select-sm w-32"},[...t[7]||(t[7]=[e("option",{value:"positive"},"正向 (+)",-1),e("option",{value:"negative"},"负向 (-)",-1)])],8,ne),[[_,o.type]]),e("button",{class:"btn btn-sm btn-circle btn-ghost",onClick:s=>S(d)},[...t[8]||(t[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ae)])])]))),128))])])])):y("",!0),r.value.length>0?(n(),l("div",ie,[e("div",de,[t[11]||(t[11]=e("h2",{class:"card-title mb-4"},"反馈循环",-1)),e("div",re,[(n(!0),l(m,null,b(x.value,(o,d)=>(n(),l("div",{key:d,class:z(["alert",o.type==="reinforcing"?"alert-success":"alert-warning"])},[e("div",null,[e("h3",ce,g(o.type==="reinforcing"?"强化循环":"平衡循环"),1),e("p",ue,g(o.path.join(" → ")),1)])],2))),128)),x.value.length===0?(n(),l("div",pe,[...t[10]||(t[10]=[e("p",null,"未发现反馈循环",-1)])])):y("",!0)])])])):y("",!0),e("div",{class:"flex gap-2 justify-end"},[e("button",{class:"btn btn-outline",onClick:B},"清空"),e("button",{class:"btn btn-primary",onClick:E},"导出")])]))}});export{fe as default};
